---
<br>
<h1>レポート</h1>
<p><b>氏名:</b> 都筑零</p>
<p><b>学部:</b> 総合政策学部</p>
<p><b>学年:</b> ３年</p>
<p><b>学籍番号:</b> 72305268</p>
<p><b>CNSメールアドレス:</b> s23526rt@sfc.keio.ac.jp</p>
<p><b>ログイン名:</b> tsuzuki</p>

<h2>収集した行動データ</h2>
    <p><b>選定した理由:</b>
        日常的な身体活動である「Standing (静止)」「Walking (歩行)」「Jumping (ジャンプ)」の3種類を選定。異なるレベルの加速度変化を持つため、機械学習による分類に適していると考えた。
    </p>
    <p><b>収集についての詳細:</b>
        スマートフォン内蔵の加速度センサー（X, Y, Z軸）からデータを収集。各アクティビティを複数回実行し、時間的に連続したシーケンスとしてデータを取得、CSV形式で出力した。
    </p>
    <p><b>工夫した点・困難だった点:</b>
        <ul>
            <li><b>工夫した点:</b> 任意のタイミングでデータ収集を制御できるように開始・停止ボタンを実装。生データとリアルタイム統計量を同時に表示・記録できるようにした。</li>
            <li><b>困難だった点:</b> デバイスの向きによる加速度値の変動、活動の境界が曖昧な点。</li>
        </ul>
    </p>

<h2>特徴量</h2>
    <p><b>選定した理由:</b>
        生データだけでは分類が困難なため、活動の「強さ」「安定性」「変動性」を示す統計量を選定。具体的には、一定の時間窓（直近50サンプル）におけるX, Y, Z軸および合計加速度の「最大値」「最小値」「平均値」「分散」を特徴量とした。
    </p>
    <p><b>追加した特徴量について:</b>
        各軸加速度（X, Y, Z）と合計加速度 (`total_accel`) について、それぞれ以下の統計量を追加した。
        <ul>
            <li>最大値 (`_max`)</li>
            <li>最小値 (`_min`)</li>
            <li>平均値 (`_mean`)</li>
            <li>分散 (`_var`)</li>
        </ul>
        これらの特徴量はPythonで計算され、元のデータに結合された。
    </p>
    <p><b>工夫した点・困難だった点:</b>
        <ul>
            <li><b>工夫した点:</b> リアルタイム統計量計算のために循環バッファを導入。分散計算はPythonのNumPyに合わせた方法を採用。</li>
            <li><b>困難だった点:</b> 適切なバッファサイズ（ACCEL_BUFFER_SIZE）の決定。PythonとJavaScript間での特徴量計算ロジックの完全一致の難しさ。</li>
        </ul>
    </p>

<h2>機械学習モデル</h2>
    <p><b>採用したアルゴリズムや学習結果の詳細:</b>
        活動分類には<b>決定木分類器 (Decision Tree Classifier)</b> を採用。`scikit-learn` を使用し、データセット（60サンプル）を訓練70%（42サンプル）、テスト30%（18サンプル）に分割して訓練。
        <br>
        <b>学習結果（テストセット18サンプルでの評価）:</b>
        <ul>
            <li><b>精度 (Accuracy):</b> 0.8333</li>
        </ul>
        <b>分類レポート:</b>
        <pre>
              precision    recall  f1-score   support

     jumping       0.83      0.83      0.83         6
    standing       0.86      1.00      0.92         6
     walking       0.80      0.67      0.73         6

    accuracy                           0.83        18
   macro avg       0.83      0.83      0.83        18
weighted avg       0.83      0.83      0.83        18
        </pre>
        <b>混同行列:</b>
        <pre>
          jumping  standing  walking
jumping         5         0        1
standing        0         6        0
walking         1         1        4
        </pre>
        全体精度は約83%。`standing` は完璧に分類。`walking` は`jumping`や`standing`と一部誤分類が見られた。
    </p>
    <p><b>工夫した点・困難だった点:</b>
        <ul>
            <li><b>工夫した点:</b> データが小規模なため、`stratify`でクラス比率を維持して分割。過学習抑制のため`max_depth=5`を設定。</li>
            <li><b>困難だった点:</b> PythonモデルをJavaScriptに直接移植できないため、<b>Pythonモデルの分析結果に基づいた簡易ルールベースの分類ロジックをJavaScriptで構築</b>。この手動調整は困難が伴った。</li>
        </ul>
    </p>

<h2>実機に移植しての性能評価</h2>
    <p><b>評価尺度について:</b>
        リアルタイム分類の体感精度（目視）と、CSV記録データによる間接的な確認を行った。
    </p>
    <p><b>評価結果:</b>
        <ul>
            <li><b>Standing:</b> 非常に安定して分類された。</li>
            <li><b>Jumping:</b> 比較的分類されるが、`walking`と誤分類される場合あり。</li>
            <li><b>Walking:</b> `jumping`と誤分類されることが多い。歩行中の動きがジャンプのような大きな加速度変動として捉えられる傾向。</li>
            <li><b>Unknown:</b> 定義ルール外の動きで表示された。</li>
        </ul>
        `standing`は良好だが、`walking`と`jumping`の分類に改善の余地がある。
    </p>
    <p><b>工夫した点・困難だった点:</b>
        <ul>
            <li><b>工夫した点:</b> リアルタイム表示で迅速なデバッグ・ルール調整。CSV記録で誤分類時のデータ分析を可能にした。</li>
            <li><b>困難だった点:</b> 手動ルール調整の難しさ。デバイスセンサー特性とモデル訓練のギャップ。リアルタイム性と安定性のバランスを取る`ACCEL_BUFFER_SIZE`の調整。</li>
        </ul>
    </p>
